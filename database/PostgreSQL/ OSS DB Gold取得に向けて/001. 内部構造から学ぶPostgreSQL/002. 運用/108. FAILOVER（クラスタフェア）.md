## フェイルオーバーの流れ
1. プライマリサーバの故障を検知。
2. 故障したプライマリサーバを確実に停止する。
3. `pg_ctl promote`で、スタンバイサーバをプライマリへ昇格。
4. 旧プライマリは`pg_basebackup`等でスタンバイサーバとして復旧する。

## クラスタウェアを使うと↑のほとんどが自動化される。
1. **異常をクラスタウェアが即座に検知する。**
2. **STONITH（Shoot The Other Node In The Head）機能で故障したプライマリを強制停止する。**
3. PostgreSQL リソースエージェントが自動で`pg_ctl promote`相当を実行する。
4. ※ツールによって※ 自動で旧プライマリを再同期（再スタンバイ化）。

## 故障したプライマリを起動したままスタンバイサーバをプライマリ昇格してしまった場合
🔴**スプリットブレイン**🔴という状態になる。文字通り「脳」が２つ。
- 両方に別のトランザクションが書き込まれる
- データ不整合が発生し、自動解決できない
- 再同期のために片方を捨てるか、手動でマージが必要になる（非常に大変）

