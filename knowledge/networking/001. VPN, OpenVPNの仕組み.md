### 参考
[SSL 認証 の仕組みと OpenVPN の認証の仕組み](https://server-setting.info/blog/ssl-openvpn-authentication.html)

### カフェのFreeWifiが危ない理由 -> 復号はされないが盗聴はされる可能有あり

カフェの無料Wifiから社内ネットワークにHTTPS通信できるとしよう。<br>
```
カフェ ⇔ カフェのAP ⇔ ルーター ⇔ ネットワーク ⇔ 社内ルータ ⇔ 社内サーバ
```
カフェのAP が悪意のある人によって用意されたものの場合、**データ自体がここで抜き取られる可能性はある。**
抜きとられるが、HTTPSでやり取りするサイトであれば**データは暗号化されるので盗聴されても復号はされない。**

### VPNを使う -> 特定のネットワークとのやり取りをすべて暗号化させたい。
- HTTPSだと「多クライアント vs 1サーバ」である -> **ブラウザ経由/サーバ単位で通信を暗号化するもの**
- VPNは「1クライアント vs 1**ネットワーク**」間を暗号化する。
<img width="500" alt="スクリーンショット 2021-05-27 22 19 26" src="https://github.com/daisuketakakuwa/learning-stack/assets/66095465/bc3f3edf-8272-4f61-ba9f-8850bdfdfcf2">

### Open VPN
```
OpenVPNは双方向の認証をサポートしています。
したがって、信頼された接続を確立するためにはクライアントはサーバーの証明書を認証し、
サーバーはクライアントの証明書を認証する必要があります。
```
ん？「VPN接続はSSL証明書が不要」なのではなかったか。。。。？<br>
→調べてみたら、”OpenVPN”="SSL-VPN"を指すらしく、SSL-VPNでは「SSL/TLS接続」をするから必然的に必要ということらしい。。<br>
<br>
✓OpenVPN＝SSL-VPNのこと。<br>
✓SSL・TLS接続するので、証明書が必要。<br>
<br>
**SSL/TLSを用いたOpenVPN認証**<br>
・SSL/TLS認証手続きを「サーバ・クライアント」の両方で行う。<br>
**★自前の認証局(プライベート認証局)を利用している。**<br>
<br>
認証の流れ ★1,2,3,4はSSL/TLSと同じ。5から違う★<br>
1. VPNサーバへ接続要求 → サーバ証明書を受け取る。
2. サーバ証明書の署名(サーバ公開鍵)は、CA秘密鍵で暗号化しているのでCA公開鍵で復号化する。【サーバの信頼性〇】
3. ランダム数値(共通鍵)生成→2のサーバ公開鍵で暗号化＆サーバに送付
4. サーバ秘密鍵で3の共通鍵を復号化→共通鍵取得
5. サーバはクライアント証明書を要求 → 取得
6. クライアント証明書の署名(クライアントの公開鍵)は、CA秘密鍵で暗号化しているのでCA公開鍵で復号化する。【クライアントの信頼性〇】
<br>
✓OpenVPN(SSL-VPN)では、自前の認証局(CA)を利用する<br>
✓サーバ認証に加えて、クライアントに認証もやるのがOpenVPN(SSL-VPN)<br>

### AWS環境におけるVPNサーバは？
```
AWSクラウド内のVPC(ネットワーク)とやり取りしたい場合、
AWSクラウド内に【VPCサーバ機能付きルータに該当するもの】を設定する必要がある。
　↓
それが【AWSClinetVPN」である。
```
